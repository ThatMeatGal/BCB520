{
  "hash": "1606015fd80c71929786138ad1ca1071",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hockey\"\nauthor: \"YG\"\ndate: \"2025-03-24\"\ncategories: [analysis]\nimage: \"image.jpg\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressMessages({\n  library(here)\n  library(dplyr)\n  library(tidyr)\n  library(readxl)\n  library(stringr)\n  library(ggplot2)})\n```\n:::\n\n\n\n# Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\naward <- read_excel(\"data/award.xlsx\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Ranking\")\nbarrie <- read_excel(\"data/Barrie.xlsx\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Rank\")\nbetsy <- read_excel(\"data/BetsyChurchHockeyBallot.xlsx\") |>\n  rename(\"voter\" = \"Name\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player Name\",\n         \"rank\" = \"Nomination position\")\nranking <- read.csv(\"data/Hockey_Ranking_CS.csv\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Rank\")\nian <- read_excel(\"data/IAN HOCKEY NOMINATIONS.xlsx\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Trophy\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Rank\")\njohn <- read.csv(\"data/JohnCambareriHockeyAwards.csv\") |>\n  mutate(voter = \"John\") |>\n  rename(\"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Place\")\nmarwa <- read_excel(\"data/marwa.xlsx\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Rank\")\nnhl <- read_excel(\"data/NHL award ballot HT.xlsx\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Rank\")\nsharon <- readRDS(\"data/sharon_ballot.rds\") |>\n  rename(\"voter\" = \"Voter\",\n         \"award\" = \"Award\",\n         \"player\" = \"Player\",\n         \"rank\" = \"Rank\")\nnhlballet <- read_excel(\"data/NHL_Award_Ballet.xlsx\") |>\n  rename(voter = Voters,\n         rank = Rank) |>\n  mutate(voter = \"Priya\")|>\n  pivot_longer(cols = -c(voter, rank), names_to = \"award\", values_to = \"player\")\n```\n:::\n\n\n\n## Nominations combined \n\n\n::: {.cell}\n\n```{.r .cell-code}\nc <- bind_rows(award, barrie, betsy, ian, john, marwa, nhl, ranking, sharon, nhlballet) |>\n  mutate(points = case_when(\n    rank == 1 ~ 10,\n    rank == 2 ~ 7,\n    rank == 3 ~ 5,\n    rank == 4 ~ 3,\n    rank == 5 ~ 1,\n  )) |>\n  mutate(award = str_to_lower(award)) |>  # Convert to lowercase for easier matching\n  mutate(award = case_when(\n    str_detect(award, \"calder\") ~ \"Calder Memorial\",\n    str_detect(award, \"hart|heart\") ~ \"Hart Memorial\",\n    str_detect(award, \"norris\") ~ \"James Norris Memorial\",\n    str_detect(award, \"selke|frank\") ~ \"Frank Selke Memorial\",\n    str_detect(award, \"byng|btng|lady\") ~ \"Lady Byng Memorial\",\n    str_detect(award, \"vezina\") ~ \"Vezina\",\n    TRUE ~ award)) # Keep original if no match\n\noverall_player_ranking <- c |>\n  group_by(player) |>\n  summarise(total_points = sum(points, na.rm = TRUE)) |>\n  arrange(desc(total_points))\n```\n:::\n\n\n\n## By Award\n### Calder Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCalder <- c |>\n  filter(award == \"Calder Memorial\") |>\n  group_by(player) |>\n  summarise(total_points = sum(points, na.rm = TRUE)) |>\n  arrange(desc(total_points))\n```\n:::\n\n\n\n### Hart Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHart <- c |>\n  filter(award == \"Hart Memorial\") |>\n  group_by(player) |>\n  summarise(total_points = sum(points, na.rm = TRUE)) |>\n  arrange(desc(total_points))\n```\n:::\n\n\n\n### James Norris Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNorris <- c |>\n  filter(award == \"James Norris Memorial\") |>\n  group_by(player) |>\n  summarise(total_points = sum(points, na.rm = TRUE)) |>\n  arrange(desc(total_points))\n```\n:::\n\n\n\n### Frank Selke Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSelke <- c |>\n  filter(award == \"Frank Selke Memorial\") |>\n  group_by(player) |>\n  summarise(total_points = sum(points, na.rm = TRUE)) |>\n  arrange(desc(total_points))\n```\n:::\n\n\n\n### Lady Byng Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLady <- c |>\n  filter(award == \"Lady Byng Memorial\") |>\n  group_by(player) |>\n  summarise(total_points = sum(points, na.rm = TRUE)) |>\n  arrange(desc(total_points))\n```\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}